{"ast":null,"code":"var _jsxFileName = \"/Users/yanghaochen/Desktop/CS185/CS185_hw8/src/Components/Add_movie.js\";\nimport React, { Component } from 'react';\nimport config from '../config.js'; // import './Movie.css';\n\nconst axios = require('axios');\n\nconst firebase = require('firebase');\n\nexport class Add_movie extends Component {\n  constructor(props) {\n    super();\n\n    this.myFormHandler = event => {\n      event.preventDefault();\n      let req = 'https://www.omdbapi.com/?apikey=2259a45a&i=' + this.state.movId;\n      this.getMovieName(this, req);\n    };\n\n    this.inputHandler = event => {\n      let field = event.target.name;\n      let value = event.target.value;\n      this.setState({\n        [field]: value\n      });\n    };\n\n    this.state = {\n      movId: '',\n      src: '',\n      title: '',\n      director: '',\n      imdb: '',\n      plot: ''\n    };\n  }\n\n  componentDidMount() {\n    if (!firebase.apps.length) {\n      firebase.initializeApp(config);\n    }\n  }\n\n  updateDb(obj) {\n    let formObj = {\n      name: obj.state.title,\n      src: obj.state.src,\n      director: obj.state.director,\n      imdb: obj.state.imdb,\n      plot: obj.state.plot\n    };\n    let ref = firebase.database().ref('movies');\n    ref.once('value').then(function (snapshot) {\n      let movExists = snapshot.child(obj.state.movId).exists();\n\n      if (movExists) {\n        alert('Already existed');\n      } else {\n        ref.child(obj.state.movId).set(formObj);\n        alert('Movie has been add');\n      }\n    });\n  }\n\n  getMovieName(obj, req) {\n    axios.get(req).then(function (response) {\n      obj.setState({\n        src: response.data.Poster,\n        title: response.data.Title,\n        director: response.data.Director,\n        imdb: response.data.imdbRating,\n        plot: response.data.Plot\n      });\n    }).then(function () {\n      obj.updateDb(obj);\n    }).catch(function (error) {\n      console.log(error);\n    });\n  }\n\n  render() {\n    return /*#__PURE__*/React.createElement(\"div\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 76,\n        columnNumber: 7\n      }\n    }, /*#__PURE__*/React.createElement(\"form\", {\n      onSubmit: this.myFormHandler,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 77,\n        columnNumber: 9\n      }\n    }, /*#__PURE__*/React.createElement(\"h1\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 78,\n        columnNumber: 11\n      }\n    }, \"Add a New Movie\"), /*#__PURE__*/React.createElement(\"h3\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 79,\n        columnNumber: 11\n      }\n    }, \"Movie ID\"), /*#__PURE__*/React.createElement(\"input\", {\n      name: \"movId\",\n      type: \"text\",\n      required: true,\n      onChange: this.inputHandler,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 80,\n        columnNumber: 11\n      }\n    }), /*#__PURE__*/React.createElement(\"br\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 80,\n        columnNumber: 90\n      }\n    }), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"color_grey\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 81,\n        columnNumber: 11\n      }\n    }, /*#__PURE__*/React.createElement(\"h5\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 81,\n        columnNumber: 39\n      }\n    }, \"* Please give the imdbID of the movie\"), \" \"), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"submit\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 82,\n        columnNumber: 11\n      }\n    }, /*#__PURE__*/React.createElement(\"input\", {\n      type: \"submit\",\n      name: \"submit\",\n      value: \"SUBMIT\",\n      style: {\n        width: \"300px\"\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 82,\n        columnNumber: 35\n      }\n    }))));\n  }\n\n}\nexport default Add_movie;","map":{"version":3,"sources":["/Users/yanghaochen/Desktop/CS185/CS185_hw8/src/Components/Add_movie.js"],"names":["React","Component","config","axios","require","firebase","Add_movie","constructor","props","myFormHandler","event","preventDefault","req","state","movId","getMovieName","inputHandler","field","target","name","value","setState","src","title","director","imdb","plot","componentDidMount","apps","length","initializeApp","updateDb","obj","formObj","ref","database","once","then","snapshot","movExists","child","exists","alert","set","get","response","data","Poster","Title","Director","imdbRating","Plot","catch","error","console","log","render","width"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\nimport config from '../config.js';\n// import './Movie.css';\n\n\nconst axios = require('axios');\nconst firebase = require('firebase')\n\n\nexport class Add_movie extends Component {\n  constructor(props) {\n    super();\n    this.state = { movId: '', src: '', title: '', director: '', imdb: '',plot: '',}\n  }\n\n  componentDidMount(){\n    if (!firebase.apps.length) {\n      firebase.initializeApp(config);\n    }\n  }\n\n  myFormHandler = (event) => {\n    event.preventDefault();\n    let req = 'https://www.omdbapi.com/?apikey=2259a45a&i='+this.state.movId;\n    this.getMovieName(this, req);\n  }\n\n  inputHandler = (event) => {\n    let field = event.target.name;\n    let value = event.target.value;\n    this.setState({[field]: value});\n  }\n\n  updateDb(obj) {\n    let formObj = {\n      name: obj.state.title,\n      src: obj.state.src,\n      director: obj.state.director,\n      imdb: obj.state.imdb,\n      plot: obj.state.plot,\n    };\n    let ref = firebase.database().ref('movies');\n    ref.once('value').then(function(snapshot) {\n      let movExists = snapshot.child(obj.state.movId).exists();\n      if(movExists) {\n        alert('Already existed');\n      } \n      else {\n        ref.child(obj.state.movId).set(formObj);\n        alert('Movie has been add');\n      }\n    });\n  }\n\n  getMovieName(obj, req) {\n    axios.get(req)\n    .then(function (response) {\n      obj.setState({\n        src: response.data.Poster,\n        title: response.data.Title,\n        director: response.data.Director,\n        imdb: response.data.imdbRating,\n        plot: response.data.Plot,\n      });\n    })\n    .then(function () {\n      obj.updateDb(obj);\n    })\n    .catch(function (error) {\n      console.log(error);\n    })\n  }\n\n  render() {\n    return(\n      <div>\n        <form onSubmit={this.myFormHandler}>\n          <h1>Add a New Movie</h1>\n          <h3>Movie ID</h3>\n          <input name='movId' type='text'  required onChange={this.inputHandler}></input><br/>\n          <div className=\"color_grey\"><h5>* Please give the imdbID of the movie</h5> </div>\n          <div className=\"submit\"><input type='submit' name='submit' value='SUBMIT' style={{width: \"300px\"}}></input></div>\n          \n        </form>\n      </div>      \n    );\n  }\n}\nexport default Add_movie;\n"]},"metadata":{},"sourceType":"module"}